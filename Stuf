local StuffsModule = {}

local PingsOrFpsEnabled = false
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local RunService = game:GetService("RunService")

-- GUI setup
local ScreenGui
local FpsPingLabel

local function createGui()
	if ScreenGui then return end -- Prevent multiple GUIs

	ScreenGui = Instance.new("ScreenGui")
	ScreenGui.Name = "FpsPingGui"
	ScreenGui.ResetOnSpawn = false
	ScreenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")

	FpsPingLabel = Instance.new("TextLabel")
	FpsPingLabel.Name = "FpsPingLabel"
	FpsPingLabel.Size = UDim2.new(0, 200, 0, 50)
	FpsPingLabel.Position = UDim2.new(0, 10, 0, 10)
	FpsPingLabel.BackgroundTransparency = 0.5
	FpsPingLabel.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
	FpsPingLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
	FpsPingLabel.Font = Enum.Font.SourceSansBold
	FpsPingLabel.TextSize = 20
	FpsPingLabel.Parent = ScreenGui
end

-- FPS calculation
local lastTime = tick()
local frameCount = 0
local fps = 0

RunService.RenderStepped:Connect(function(deltaTime)
	if not PingsOrFpsEnabled then
		if ScreenGui then
			ScreenGui.Enabled = false
		end
		return
	end

	createGui()
	ScreenGui.Enabled = true

	-- FPS calculation
	frameCount = frameCount + 1
	if tick() - lastTime >= 1 then
		fps = frameCount
		frameCount = 0
		lastTime = tick()
	end

	-- Ping calculation
	local ping = math.floor(LocalPlayer:GetNetworkPing() * 1000) -- in ms

	-- Update text
	FpsPingLabel.Text = string.format("Fps:%03d/Pings:%03d", fps, ping)
end)

-- Toggle function
function StuffsModule:SetPingsOrFps(state)
	PingsOrFpsEnabled = state
	if ScreenGui then
		ScreenGui.Enabled = state
	end
end

return StuffsModule
